<p>  http1.1版本以前，开始的时候，每进行一次HTTP通信就要断开一次TCP连接。也就是如果需要建立一个HTTP通信，那么得先建立TCP连接，然后发送HTTP请求和响应HTTP请求，然后关闭TCP连接，然后再进行下一次HTTP通信。<br>  用上面的方式，如果页面中的内容很少倒也还好，但是如果一个网页里面包含了大量的图片、js、css等资源的情况下，那么每次的请求都会造成无谓的TCP连接建立和断开，增加通信量的开销。<br>  为了解决TCP连接频繁建立和断开的问题，HTTP1.0版本后期就出了一个Connection头，决定当前的事务完成后，是否会关闭网络连接。<br>  <strong>Connection</strong>头主要有两个取值：<br>1、<strong>close</strong>：表明客户端或服务器想要关闭该网络连接，这是HTTP/1.0请求的默认值。<br>2、以逗号分隔的HTTP头 [通常仅有 <strong>keep-alive</strong>]：表明客户端想要保持该网络连接打开，HTTP/1.1的请求默认使用一个持久连接。这个请求头列表由头部名组成，这些头将被第一个非透明的代理或者代理间的缓存所移除：这些头定义了发出者和第一个实体之间的连接，而不是和目的地节点间的连接。<br>  持久连接的好处在于减少了TCP连接的重复建立和断开所造成的额外开销，减轻了通信双方的负载。另外减少的开销的那部分时间，使HTTP请求和响应能够更早的结束，也提高了web页面的响应速度。<br>  持久连接另一个用处是使得请求可以以<strong>管线化</strong>的方式发送。即客户端有多个请求需要发送时，发出一个请求后，不等待响应结果就直接发出下一个请求。<br>  如果你打开chrome浏览器的network查看我们的请求响应的话，就会发现浏览器会先加载head中的资源，加载完成之后再加载body中的资源，在同一时间最多发送了六个请求，在这六个请求中的其中一个请求响应完成后，又发送下一个请求，如此直到所有的请求都完成为止。这样可以使得所有的请求能更快的完成。当然这个连接也不会一直保留着：连接在空闲一段时间后会被关闭。<br>  上面说到了keep-alive，我们还是来看看keep-alive怎么用的吧。<br>  <strong>Keep-Alive</strong> 是一个通用消息头，允许消息发送者暗示连接的状态，还可以用来设置超时时长和最大请求数。需要设置Connection:keep-alive才有效。如：Keep-Alive: timeout=5, max=1000<br>  <strong>timeout</strong>：指定了一个空闲连接需要保持打开状态的最小时长（以秒为单位）。需要注意的是，如果没有在传输层设置 keep-alive TCP message 的话，大于 TCP 层面的超时设置会被忽略。<br>    <strong>max</strong>：在连接关闭之前，在此连接可以发送的请求的最大值。在非管道连接中，除了 0 以外，这个值是被忽略的，因为需要在紧跟着的响应中发送新一次的请求。HTTP 管道连接则可以用它来限制管道的使用。</p>
