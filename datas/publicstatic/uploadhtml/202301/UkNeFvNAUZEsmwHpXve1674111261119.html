<p>UDP和TCP有什么区别？</p>
<pre><code><span class="code-block">TCP协议在传送数据段的时候要给段标号；UDP协议不
TCP协议可靠；UDP协议不可靠
TCP协议是面向连接；UDP协议采用无连接
TCP协议负载较高，采用虚电路；UDP采用无连接
TCP协议的发送方要确认接收方是否收到数据段（3次握手协议）
TCP协议采用窗口技术和流控制</span>
</code><span class="copy-button">复制代码</span></pre>
<p>特性 	TCP 	UDP<br>是否连接 	面向连接 	面向非连接<br>传输可靠性 	可靠 	不可靠<br>应用场合 	传输大量数据 	传输少量数据<br>速度 	慢 	快</p>
<p>TCP传输的详细过程是怎样的？<br>进行三次握手，建立TCP连接。</p>
<pre><code><span class="code-block">第一次握手：建立连接。客户端发送连接请求报文段，将<span class="hljs-variable constant_">SYN</span>位置为<span class="hljs-number">1</span>，<span class="hljs-title class_">Sequence</span> <span class="hljs-title class_">Number</span>为x；然后，客户端进入<span class="hljs-variable constant_">SYN_SEND</span>状态，等待服务器的确认；
第二次握手：服务器收到<span class="hljs-variable constant_">SYN</span>报文段。服务器收到客户端的<span class="hljs-variable constant_">SYN</span>报文段，需要对这个<span class="hljs-variable constant_">SYN</span>报文段进行确认，设置<span class="hljs-title class_">Acknowledgment</span> <span class="hljs-title class_">Number</span>为x+<span class="hljs-number">1</span>(<span class="hljs-title class_">Sequence</span> <span class="hljs-title class_">Number</span>+<span class="hljs-number">1</span>)；同时，自己自己还要发送<span class="hljs-variable constant_">SYN</span>请求信息，将<span class="hljs-variable constant_">SYN</span>位置为<span class="hljs-number">1</span>，<span class="hljs-title class_">Sequence</span> <span class="hljs-title class_">Number</span>为y；服务器端将上述所有信息放到一个报文段（即<span class="hljs-variable constant_">SYN</span>+<span class="hljs-variable constant_">ACK</span>报文段）中，一并发送给客户端，此时服务器进入<span class="hljs-variable constant_">SYN_RECV</span>状态；
第三次握手：客户端收到服务器的<span class="hljs-variable constant_">SYN</span>+<span class="hljs-variable constant_">ACK</span>报文段。然后将<span class="hljs-title class_">Acknowledgment</span> <span class="hljs-title class_">Number</span>设置为y+<span class="hljs-number">1</span>，向服务器发送<span class="hljs-variable constant_">ACK</span>报文段，这个报文段发送完毕以后，客户端和服务器端都进入<span class="hljs-variable constant_">ESTABLISHED</span>状态，完成<span class="hljs-variable constant_">TCP</span>三次握手。
完成了三次握手，客户端和服务器端就可以开始传送数据。

<span class="hljs-variable constant_">ACK</span>：此标志表示应答域有效，就是说前面所说的<span class="hljs-variable constant_">TCP</span>应答号将会包含在<span class="hljs-variable constant_">TCP</span>数据包中；有两个取值：<span class="hljs-number">0</span>和<span class="hljs-number">1</span>，为<span class="hljs-number">1</span>的时候表示应答域有效，反之为<span class="hljs-number">0</span>。
<span class="hljs-variable constant_">TCP</span>协议规定，只有<span class="hljs-variable constant_">ACK</span>=<span class="hljs-number">1</span>时有效，也规定连接建立后所有发送的报文的<span class="hljs-variable constant_">ACK</span>必须为<span class="hljs-number">1</span>。
<span class="hljs-title function_">SYN</span>(<span class="hljs-title class_">SYNchronization</span>) ： 在连接建立时用来同步序号。当<span class="hljs-variable constant_">SYN</span>=<span class="hljs-number">1</span>而<span class="hljs-variable constant_">ACK</span>=<span class="hljs-number">0</span>时，表明这是一个连接请求报文。对方若同意建立连接，则应在响应报文中使<span class="hljs-variable constant_">SYN</span>=<span class="hljs-number">1</span>和<span class="hljs-variable constant_">ACK</span>=<span class="hljs-number">1.</span> 因此, <span class="hljs-variable constant_">SYN</span>置<span class="hljs-number">1</span>就表示这是一个连接请求或连接接受报文。
<span class="hljs-variable constant_">FIN</span> （finis）即完，终结的意思， 用来释放一个连接。当 <span class="hljs-variable constant_">FIN</span> = <span class="hljs-number">1</span> 时，表明此报文段的发送方的数据已经发送完毕，并要求释放连接。</span>
</code><span class="copy-button">复制代码</span></pre>
<p>发送HTTP请求，服务器处理请求，返回响应结果</p>
<p>TCP连接建立后，浏览器就可以利用HTTP／HTTPS协议向服务器发送请求了。服务器接受到请求，就解析请求头，如果头部有缓存相关信息如if-none-match与if-modified-since，则验证缓存是否有效，若有效则返回状态码为304，若无效则重新返回资源，状态码为200.<br>关闭TCP连接</p>
<pre><code><span class="code-block">第一次分手：主机<span class="hljs-number">1</span>（可以使客户端，也可以是服务器端），设置<span class="hljs-title class_">Sequence</span> <span class="hljs-title class_">Number</span>和<span class="hljs-title class_">Acknowledgment</span> <span class="hljs-title class_">Number</span>，向主机<span class="hljs-number">2</span>发送一个<span class="hljs-variable constant_">FIN</span>报文段；此时，主机<span class="hljs-number">1</span>进入<span class="hljs-variable constant_">FIN_WAIT_1</span>状态；这表示主机<span class="hljs-number">1</span>没有数据要发送给主机<span class="hljs-number">2</span>了；
第二次分手：主机<span class="hljs-number">2</span>收到了主机<span class="hljs-number">1</span>发送的<span class="hljs-variable constant_">FIN</span>报文段，向主机<span class="hljs-number">1</span>回一个<span class="hljs-variable constant_">ACK</span>报文段，<span class="hljs-title class_">Acknowledgment</span> <span class="hljs-title class_">Number</span>为<span class="hljs-title class_">Sequence</span> <span class="hljs-title class_">Number</span>加<span class="hljs-number">1</span>；主机<span class="hljs-number">1</span>进入<span class="hljs-variable constant_">FIN_WAIT_2</span>状态；主机<span class="hljs-number">2</span>告诉主机<span class="hljs-number">1</span>，我“同意”你的关闭请求；
第三次分手：主机<span class="hljs-number">2</span>向主机<span class="hljs-number">1</span>发送<span class="hljs-variable constant_">FIN</span>报文段，请求关闭连接，同时主机<span class="hljs-number">2</span>进入<span class="hljs-variable constant_">LAST_ACK</span>状态；
第四次分手：主机<span class="hljs-number">1</span>收到主机<span class="hljs-number">2</span>发送的<span class="hljs-variable constant_">FIN</span>报文段，向主机<span class="hljs-number">2</span>发送<span class="hljs-variable constant_">ACK</span>报文段，然后主机<span class="hljs-number">1</span>进入<span class="hljs-variable constant_">TIME_WAIT</span>状态；主机<span class="hljs-number">2</span>收到主机<span class="hljs-number">1</span>的<span class="hljs-variable constant_">ACK</span>报文段以后，就关闭连接；此时，主机<span class="hljs-number">1</span>等待2MSL后依然没有收到回复，则证明<span class="hljs-title class_">Server</span>端已正常关闭，那好，主机<span class="hljs-number">1</span>也可以关闭连接了。</span>
</code><span class="copy-button">复制代码</span></pre>
